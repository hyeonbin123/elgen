<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>í™˜ìì •ë³´ê´€ë¦¬</title>

    <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
    <!-- Custom fonts for this template-->
    <link href="/static/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="/static/css/common.css" rel="stylesheet">
    <!-- datepicker custom design -->
    <link href="/static/css/datepicker.css" rel="stylesheet">
    <link href="/static/css/radiobutton.css" rel="stylesheet">
    <link href="/static/css/sb-admin-2.min.css" rel="stylesheet">
    <link href="/static/css/selectbox.css" rel="stylesheet">
    <!-- datepicker -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker.min.css" integrity="sha512-vyxlyD6m54QfZ9PpnWfOHY8Lk3EcN1HuSYalLg3qqnqXLKTbRC/45lvy34WkngM1BUrYuJw1W1ZHlgEpdAn5Xg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
    #rejectListModal{
        z-index: 1101 !important;
    }
    </style>
</head>

<body id="page-top" class="sidebar-toggled">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Include Sidebar -->
        {% include 'audio/include/sidebar.html' %}

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Include Header -->
                {% include 'audio/include/header.html' %}

                <!-- Begin Page Content -->
                <div class="container-fluid">

                    <!-- Page Heading -->
                    <h1 class="h3 mb-2 text-gray-800">
                        <i class="fas fa-fw fa-hospital-user"></i>
                        í™˜ìì •ë³´ê´€ë¦¬
                    </h1>
                    <p class="mb-4">ì¶©ë‚¨ëŒ€í•™êµë³‘ì› í™˜ìì •ë³´ê´€ë¦¬ì‹œìŠ¤í…œ</p>

                    <div class="row">
                        <!-- Area Chart -->
                        <div class="col-xl-12 col-lg-12">
                            <div class="card shadow mb-4">
                                <div id="searchHeader"
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">ğŸ” ê²€ìƒ‰
                                        &nbsp;&nbsp;&nbsp;<a href="/patientList" class="d-none d-sm-inline-block btn btn-sm btn-secondary shadow-sm">ê²€ìƒ‰ì¡°ê±´ì´ˆê¸°í™”</a>
                                    </h6>
                                </div>
                                <!-- Card Body -->
                                <div id="searchBody" class="card-body">
                                    <div class="row" style="margin-left:1px;">
                                        <input type="radio" name="box" id="allBtn" value="all" {% if page_list.is_deleted == "all" %}checked{% endif %}>
                                        <input type="radio" name="box" id="notExpiredBtn" value="N" {% if page_list.is_deleted == "N" %}checked{% endif %}>
                                        <input type="radio" name="box" id="expiredBtn" value="Y" {% if page_list.is_deleted == "Y" %}checked{% endif %}>

                                        <label for="allBtn" class="box first {% if page_list.is_deleted == 'all' %}hoverRadioBtn{% endif %}">
                                            <div class="course">
                                                <span class="circle"></span>
                                                <span class="subject">í™˜ìì „ì²´</span>
                                            </div>
                                        </label>

                                        <label for="notExpiredBtn" class="box second {% if page_list.is_deleted == 'N' %}hoverRadioBtn{% endif %}">
                                            <div class="course">
                                                <span class="circle"></span>
                                                <span class="subject">ë§Œë£Œí™˜ì ì œì™¸</span>
                                            </div>
                                        </label>

                                        <label for="expiredBtn" class="box third {% if page_list.is_deleted == 'Y' %}hoverRadioBtn{% endif %}">
                                            <div class="course">
                                                <span class="circle"></span>
                                                <span class="subject">ë§Œë£Œí™˜ìë§Œ ì¡°íšŒ</span>
                                            </div>
                                        </label>
                                    </div>

                                    <hr>
                                    <div class="mb-3">
                                        <select id="countPerPage" onchange="if(this.value) location.href=(this.value);">
                                            <option data-value="10" value="?pagenum=1&countperpage=10&order={{ page_list.order }}&key={{ page_list.key }}&value={{ page_list.value }}&type={{ page_list.type }}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}&department={{ page_list.department }}&is_deleted={{ page_list.is_deleted }}" {% if page_list.countperpage == 10 %}selected{% endif %}>10ê°œì”© ë³´ê¸°</option>
                                            <option data-value="20" value="?pagenum=1&countperpage=20&order={{ page_list.order }}&key={{ page_list.key }}&value={{ page_list.value }}&type={{ page_list.type }}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}&department={{ page_list.department }}&is_deleted={{ page_list.is_deleted }}" {% if page_list.countperpage == 20 %}selected{% endif %}>20ê°œì”© ë³´ê¸°</option>
                                            <option data-value="30" value="?pagenum=1&countperpage=30&order={{ page_list.order }}&key={{ page_list.key }}&value={{ page_list.value }}&type={{ page_list.type }}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}&department={{ page_list.department }}&is_deleted={{ page_list.is_deleted }}" {% if page_list.countperpage == 30 %}selected{% endif %}>30ê°œì”© ë³´ê¸°</option>
                                            <option data-value="50" value="?pagenum=1&countperpage=50&order={{ page_list.order }}&key={{ page_list.key }}&value={{ page_list.value }}&type={{ page_list.type }}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}&department={{ page_list.department }}&is_deleted={{ page_list.is_deleted }}" {% if page_list.countperpage == 50 %}selected{% endif %}>50ê°œì”© ë³´ê¸°</option>
                                        </select>
                                        <select id="department" class="longSelect" onchange="if(this.value) location.href=(this.value);">
                                            <option data-value="all" value="?pagenum=1&countperpage={{ page_list.countperpage }}&order={{ page_list.order }}&type={{ page_list.type }}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}&department=all&is_deleted={{ page_list.is_deleted }}" {% if page_list.department == 'all' %}selected{% endif %}>ë¶€ì„œ ì „ì²´</option>
                                            {% for department in department_list %}
                                                <option data-value="{{ department.d_code }}" value="?pagenum=1&countperpage={{ page_list.countperpage }}&order={{ page_list.order }}&type=recDate{% if page_list.type == 'recDate' %}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}{% endif %}&department={{ department.d_code }}&is_deleted={{ page_list.is_deleted }}" {% if page_list.department == department.d_code %}selected{% endif %}>{{ department.d_code }} {{ department.d_name }}</option>
                                            {% endfor %}
                                        </select>
<!--                                        <select id="doctor">-->
<!--                                            <option>ì˜ë£Œì§„ ì „ì²´</option>-->
<!--                                        </select>-->
                                        <select id="order" class="longSelect" onchange="if(this.value) location.href=(this.value);">
                                            <option data-value="desc" value="?pagenum=1&countperpage={{ page_list.countperpage }}&order=desc&key={{ page_list.key }}&value={{ page_list.value }}&type={{ page_list.type }}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}&department={{ page_list.department }}&is_deleted={{ page_list.is_deleted }}" {% if page_list.order == 'desc' %}selected{% endif %}>ì—°êµ¬ë²ˆí˜¸ì—­ìˆœ</option>
                                            <option data-value="asc" value="?pagenum=1&countperpage={{ page_list.countperpage }}&order=asc&key={{ page_list.key }}&value={{ page_list.value }}&type={{ page_list.type }}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}&department={{ page_list.department }}&is_deleted={{ page_list.is_deleted }}" {% if page_list.order == 'asc' %}selected{% endif %}>ì—°êµ¬ë²ˆí˜¸ìˆœ</option>
                                            <option data-value="oldNum" value="?pagenum=1&countperpage={{ page_list.countperpage }}&order=oldNum&key={{ page_list.key }}&value={{ page_list.value }}&type={{ page_list.type }}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}&department={{ page_list.department }}&is_deleted={{ page_list.is_deleted }}" {% if page_list.order == 'oldNum' %}selected{% endif %}>(êµ¬)ì—°êµ¬ë²ˆí˜¸ìˆœ</option>
                                            <option data-value="regId" value="?pagenum=1&countperpage={{ page_list.countperpage }}&order=regId&key={{ page_list.key }}&value={{ page_list.value }}&type={{ page_list.type }}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}&department={{ page_list.department }}&is_deleted={{ page_list.is_deleted }}" {% if page_list.order == 'regId' %}selected{% endif %}>ë³‘ì›ë“±ë¡ë²ˆí˜¸ìˆœ</option>
                                            <option data-value="name" value="?pagenum=1&countperpage={{ page_list.countperpage }}&order=name&key={{ page_list.key }}&value={{ page_list.value }}&type={{ page_list.type }}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}&department={{ page_list.department }}&is_deleted={{ page_list.is_deleted }}" {% if page_list.order == 'name' %}selected{% endif %}>í™˜ìì„±ëª…ìˆœ</option>
                                        </select>
                                    </div>

                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <button id="options" value="{{ page_list.key }}" class="btn btn-outline-secondary dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{ page_list.key_text }}</button>
                                            <div class="dropdown-menu">
                                                <a data-value="name" class="dropdown-item item1">ì„±ëª…</a>
                                                <a data-value="regNum" class="dropdown-item item1">ë³‘ì›ë“±ë¡ë²ˆí˜¸</a>
                                                <a data-value="patientNum" class="dropdown-item item1">ì—°êµ¬ë²ˆí˜¸</a>
                                            </div>
                                        </div>
                                        <input id="searchInput" type="text" class="form-control col-md-3" aria-label="Text input with dropdown button" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" {% if page_list.value != '' %}value="{{ page_list.value }}"{% endif %}>
                                        <div class="input-group-append">
                                            <button id="searchBtn" class="btn btn-secondary" type="button">
                                                <i class="fa fa-search"></i>
                                            </button>
                                        </div>
                                    </div>

                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <button id="dateOptions" value="{{ page_list.type }}" class="btn btn-outline-secondary dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{{ page_list.type_name }}</button>
                                            <div class="dropdown-menu">
                                                <a data-value="recDate" class="dropdown-item item2">ë…¹ì·¨ì¼</a>
                                                <a data-value="regDate" class="dropdown-item item2">ë™ì˜ì„œì·¨ë“ì¼</a>
                                            </div>
                                        </div>
                                        <div class="input-daterange jDaterange d-flex">
                                            <input type="text" id="startDate" {% if page_list.start_date != '' %}value="{{ page_list.start_date }}"{% endif %} class="form-control" aria-label="Text input with dropdown button" placeholder="ì‹œì‘ë‚ ì§œ">
                                            <input type="text" id="endDate" {% if page_list.end_date != '' %}value="{{ page_list.end_date }}"{% endif %} class="form-control" aria-label="Text input with dropdown button" placeholder="ëë‚ ì§œ">
                                        </div>
                                        <div class="input-group-append">
                                            <button id="dateSearchBtn" class="btn btn-secondary" type="button">
                                                <i class="fa fa-search"></i>
                                            </button>
                                        </div>
                                    </div>



                                </div>
                            </div>
                        </div>
                    </div>



                    <!-- DataTales Example -->
                    <div class="card shadow mb-4">
                        <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                            <h6 class="m-0 font-weight-bold text-primary">ë…¹ì·¨ëŒ€ìƒìëª©ë¡</h6>
                            <div class="margin-left-auto">
                                <a id="rejectBtn" class="d-none d-sm-inline-block btn btn-sm btn-secondary shadow-sm" data-toggle="modal" data-load-url="/patientList/rejectList" data-target="#rejectListModal"><i
                                class="fas fa-ban fa-sm text-white-50"></i> ê±°ë¶€ëŒ€ìƒìëª©ë¡</a>
                                <a id="expirationBtn" class="d-none d-sm-inline-block btn btn-sm btn-secondary shadow-sm" data-toggle="modal" data-load-url="/patientList/rejectList" data-target="#rejectListModal"><i
                                class="fas fa-ban fa-sm text-white-50"></i> ë™ì˜ì„œë§Œë£Œìëª©ë¡</a>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-bordered text-nowrap" width="100%" cellspacing="0">
                                    <div class="mb-3">ì¡°íšŒê²°ê³¼:<b class="left-spacing-8">{{ page_list.count }}</b>ê°œ</div>
                                    <thead style="background: #858796; color: #fff;">
                                        <tr>
                                            <th></th>
                                            <th>ì—°êµ¬ë²ˆí˜¸</th>
                                            <th>ì„±ëª…</th>
                                            <th>ë³‘ì›ë“±ë¡ë²ˆí˜¸</th>
                                            <th>ì„±ë³„</th>
                                            <th>ì—°ë ¹</th>
                                            <th>ë…¹ì·¨íŒŒì¼ê°œìˆ˜</th>
                                            <th>ë™ì˜ì„œì·¨ë“ì¼</th>
                                            <th>ë™ì˜ì„œë§Œë£Œì¼</th>
                                            <th>(êµ¬)ì—°êµ¬ë²ˆí˜¸</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% if flag == True %}
                                            <tr><td colspan="10">'(êµ¬)ì—°êµ¬ë²ˆí˜¸ìˆœ' ì •ë ¬ ê¸°ëŠ¥ì€ ì œê³µë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì •ë ¬ ê¸°ëŠ¥ì„ ì´ìš©í•´ì£¼ì„¸ìš”.</td></tr>
                                        {% endif %}
                                        {% for patient in patient_list %}

                                        <tr class="{% if patient.is_deleted == 'Y' %}red{% endif %} {% if patient.is_requested == 'Y' %}bg-yellow{% endif %}">
                                            <td>
                                                <a><i class="fa fa-wrench pointer" onclick="modifyInfo('{{ patient.reg_id }}', '{{ patient.patient_name }}', '{{ patient.patient_gender }}', {{ patient.patient_age }})"></i></a>
                                                {% if patient.is_deleted != 'Y' and patient.is_requested != 'Y' %}<a class="left-spacing-8" onclick="deleteNum('{{ patient.reg_id }}', '{{ patient.patient_name }}');"><i class="fa fa-trash pointer"></i></a>{% endif %}
                                                {% if patient.is_requested == 'Y' %}<a class="left-spacing-8" onclick="deleteRestore('{{ patient.reg_id }}', '{{ patient.patient_name }}');"><i class="fa fa-trash-restore pointer"></i></a>{% endif %}
                                            </td>
                                            <td>
                                                <a class="patientId pointer {% if patient.is_deleted == 'Y' %}red{% endif %}" data-regId="{{ patient.reg_id }}" data-name="{{ patient.patient_name }}" data-patientId="{{ patient.patient_id }}">{{ patient.patient_id }}</a>
                                            </td>
                                            <td>{{ patient.patient_name }}</td>
                                            <td>
                                                {{ patient.reg_id }}
                                                {% if patient.is_deleted != 'Y' %}<i class="fa fa-address-book pointer" onclick="modifyNum('{{ patient.reg_id }}')"></i>{% endif %}
                                            </td>
                                            <td>{% if patient.patient_gender == 'M' %}ë‚¨{% else %}ì—¬{% endif %}</td>
                                            <td>{{ patient.patient_age }}</td>
                                            <td>{{ patient.total }}</td>
                                            <td>
                                                {{ patient.registered_at|date:"Y-m-d" }}
                                                {% if patient.is_deleted != 'Y' %}<i class="fa fa-address-book pointer" onclick="modifyRegDate('{{ patient.reg_id }}', '{{ patient.registered_at|date:"Y-m-d" }}')"></i>{% endif %}
                                            </td>
                                            <td>{{ patient.delete_date|date:"Y-m-d" }}</td>
                                            <td>{% if patient.old_patient_id != None %} <!-- patient.old_patient_idê°€ Noneì´ë©´(=êµ¬í™˜ìë²ˆí˜¸ê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´) patient.old_num_list ìì²´ê°€ ì•„ì˜ˆ ìƒì„±ì´ ë˜ì§€ì•Šì•„ì„œ ì¡´ì¬í•˜ì§€ ì•ŠìŒ -->
                                                    {% for old_num in patient.old_num_list %}
                                                        {{ old_num }}&nbsp;
                                                    {% endfor %}
                                                {% endif %}
                                            </td>

                                        </tr>

                                        {% endfor %}


                                        <!-- í™˜ìì •ë³´ Modal -->
                                        <div class="modal fade" id="infoModal" tabindex="-1" aria-labelledby="infoLabel" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-scrollable">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="infoLabel">í™˜ìì •ë³´ìˆ˜ì •</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <div class="form-row">
                                                            <div class="form-group col-md-4">
                                                                <label for="name" class="text-primary">ì„±ëª…</label>
                                                                <input type="text" class="form-control" id="name" placeholder="ì„±ëª… ì…ë ¥">
                                                            </div>
                                                            <div class="form-group col-md-4">
                                                                <label for="age" class="text-primary">ì—°ë ¹</span></label>
                                                                <input type="text" class="form-control" id="age" placeholder="ì—°ë ¹ ì…ë ¥(ìˆ«ì)" maxlength="3">
                                                            </div>
                                                            <div class="form-group col-md-4">
                                                                <label for="gender" class="text-primary">ì„±ë³„</label>
                                                                <select id="gender" class="form-control">
                                                                    <option value="M">ë‚¨ì„±</option>
                                                                    <option value="F">ì—¬ì„±</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <input type="hidden" id="hiddenRegId">
                                                        </div>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-primary" onclick="infoModalSubmit();">í™•ì¸</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- ë³‘ì›ë“±ë¡ë²ˆí˜¸ìˆ˜ì • Modal -->
                                        <div class="modal fade" id="regIdModal" tabindex="-1" aria-labelledby="infoLabel" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-scrollable">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="regIdLabel">ë³‘ì›ë“±ë¡ë²ˆí˜¸ìˆ˜ì •</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <div class="form-row">
                                                            <div class="form-group col-md-12">
                                                                <label for="regNum" class="text-primary">ë³‘ì›ë“±ë¡ë²ˆí˜¸</label>
                                                                <input type="text" class="form-control" id="regNum" placeholder="ë“±ë¡ë²ˆí˜¸ 8ìë¦¬ ì…ë ¥" maxlength="8">
                                                                <input type="hidden" class="form-control" id="hiddenRegNum">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-primary" onclick="regIdModalSubmit();">í™•ì¸</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- ë™ì˜ì„œì·¨ë“ì¼ìˆ˜ì • Modal -->
                                        <div class="modal fade" id="regDateModal" tabindex="-1" aria-labelledby="infoLabel" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-scrollable">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="regDateLabel">ë™ì˜ì„œì·¨ë“ì¼ìˆ˜ì •</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <div class="form-row">
                                                            <div class="form-group col-md-12">
                                                                <label for="regNum" class="text-primary">ë™ì˜ì„œì·¨ë“ì¼</label>
                                                                <div class="input-daterange jDaterange d-flex">
                                                                    <input type="text" class="form-control" id="regDate" placeholder="ë‚ ì§œ" maxlength="8" value='{{ patient.delete_date|date:"Y-m-d" }}'>
                                                                </div>
                                                                <input id="hiddenRegId2" type="hidden">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-primary" onclick="regDateModalSubmit();">í™•ì¸</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </tbody>
                                </table>
                            </div>

                            <br>
                            <nav aria-label="Page navigation example">
                                <ul class="pagination justify-content-center">
                                    {% if calculate_list.prev %}
                                        <li class="page-item">
                                            <a class="page-link" href="?pagenum={{ calculate_list.begin_page|add:-1 }}&countperpage={{ page_list.countperpage }}&order={{ page_list.order }}&key={{ page_list.key }}&value={{ page_list.value }}&type={{ page_list.type }}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}&department={{ page_list.department }}&is_deleted={{ page_list.is_deleted }}" aria-label="Previous">
                                                <span aria-hidden="true">&laquo;</span>
                                            </a>
                                        </li>
                                    {% else %}
                                    {% endif %}

                                    {% for page_number in calculate_list.nums %}
                                        <li class="page-item {% if page_number == page_list.pagenum %}active{% endif %}"><a class="page-link" href="?pagenum={{ page_number }}&countperpage={{ page_list.countperpage }}&order={{ page_list.order }}&key={{ page_list.key }}&value={{ page_list.value }}&type={{ page_list.type }}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}&department={{ page_list.department }}&is_deleted={{ page_list.is_deleted }}">{{ page_number }}</a></li>
                                    {% endfor %}

                                    {% if calculate_list.next %}
                                        <li class="page-item">
                                            <a class="page-link" href="?pagenum={{ calculate_list.end_page|add:1 }}&countperpage={{ page_list.countperpage }}&order={{ page_list.order }}&key={{ page_list.key }}&value={{ page_list.value }}&type={{ page_list.type }}&startdate={{ page_list.start_date }}&enddate={{ page_list.end_date }}&department={{ page_list.department }}&is_deleted={{ page_list.is_deleted }}" aria-label="Next">
                                                <span aria-hidden="true">&raquo;</span>
                                            </a>
                                        </li>
                                    {% else %}
                                    {% endif %}
                                </ul>
                            </nav>

                        </div>
                    </div>


                        </div>
                    </div>

                </div>
                <!-- /.container-fluid -->

            </div>
            <!-- End of Main Content -->

            <!-- Include Footer -->
            {% include 'audio/include/footer.html' %}

        </div>
        <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    <!-- ë…¹ì·¨íŒŒì¼ëª©ë¡ Modal -->
    <div class="modal fade modal-fullscreen" id="recListModal" tabindex="-1" aria-labelledby="recListModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="recListModalLabel">ë…¹ì·¨íŒŒì¼ëª©ë¡</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive">
                        <table class="table table-bordered text-nowrap" width="100%" cellspacing="0">
                            <div class="mb-3">ì¡°íšŒê²°ê³¼:<b id="recLength" class="left-spacing-8"></b>ê°œ</div>
                            <thead style="background: #858796; color: #fff;">
                                <tr>
                                    <th>ë²ˆí˜¸</th>
<!--                                    <th>ë¶€ì„œ</th>-->
                                    <th>ë…¹ì·¨íŒŒì¼</th>
<!--                                    <th>ë…¹ì·¨ì¸</th>-->
                                    <th>DBì €ì¥ì‹œê°</th>
                                    <th>íŒŒì¼ê¸¸ì´</th>
                                </tr>
                            </thead>
                            <tbody id="tbodyArea"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ë…¹ì·¨ê±°ë¶€ëŒ€ìƒì Modal -->
    <div class="modal fade modal-fullscreen" id="rejectListModal" tabindex="-1" aria-labelledby="rejectListModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-body"></div>
            </div>
        </div>
    </div>
   <!-- ë™ì˜ì„œë§Œë£Œì Modal -->
    <div class="modal fade modal-fullscreen" id="expirationListModal" tabindex="-1" aria-labelledby="rejectListModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-body"></div>
            </div>
        </div>
    </div>
    <!-- Bootstrap core JavaScript-->
    <script src="/static/vendor/jquery/jquery.min.js"></script>
    <script src="/static/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="/static/js/common/sb-admin-2.min.js"></script>
    <!-- datepicker -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/js/bootstrap-datepicker.min.js"></script>
    <script>
        {document.addEventListener("input", onlyNumber, true);
            function onlyNumber(evt) {
                const origin = evt.target;
                if(origin.id === 'age' || origin.id === 'regNum') {
                    origin.value = origin.value
                    .replace(/[^0-9]$/i, "");
                }
            }
        }

        function modifyInfo(reg_id, name, gender, age) {
            $('#name').val(name);
            $('#age').val(age);
            $('#gender').val(gender).prop("selected",true);
            $('#hiddenRegId').val(reg_id);
            $('#infoModal').modal();
        }

        function infoModalSubmit() {
            let reg_id = $('#hiddenRegId').val();
            let name = $('#name').val();
            let age = $('#age').val();
            let gender = $('#gender').val();

            $.ajax({
                url: '/patientList/modify',
                method: "POST",
                data: {
                    reg_id : reg_id,
                    name: name,
                    age: age,
                    gender: gender
                },
                success: function(data) {
                    alert('ìˆ˜ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                },
                error: function(request, status, error) {
                    //console.log("ì—ëŸ¬: ", error);
                    alert("ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
                },
                complete: function() {
                    location.reload();
                }
            }); //end ajax
        }

        function modifyNum(reg_id) {
            $('#regNum').val(reg_id);
            $('#hiddenRegNum').val(reg_id);
            $('#regIdModal').modal();
        }

        function regIdModalSubmit() {
            let regNum = $('#regNum').val();
            console.log('regNum: ', regNum);
            let hiddenRegNum = $('#hiddenRegNum').val();
            console.log('hiddenRegNum: ', hiddenRegNum);
            if(regNum == hiddenRegNum) {
                alert('ë³€ê²½ ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            var inputLength = regNum.length;
            if(inputLength < 8) {
                alert('ë“±ë¡ë²ˆí˜¸ 8ìë¦¬ë¥¼ ê¸°ì…í•˜ì—¬ ì£¼ì„¸ìš”.');
                return;
            }

            $.ajax({
                url: '/patientList/modifyRegNum',
                method: "POST",
                data: {
                    reg_id : regNum,
                    prev_reg_id : hiddenRegNum
                },
                success: function(data) {
                    alert('ìˆ˜ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                },
                error: function(request, status, error) {
                    //console.log("ì—ëŸ¬: ", error);
                    alert(request.responseJSON.message);
                },
                complete: function() {
                    location.reload();
                }
            }); //end ajax
        }

        function deleteNum(reg_id, name) {

            var result = confirm('ğŸš¨ í™•ì¸ì„ ëˆ„ë¥´ì‹œë©´ ' + name + 'ë‹˜ì˜ ì •ë³´ì™€ ëª¨ë“  ë…¹ì·¨ íŒŒì¼ì€ ìì •ì— ì‚­ì œë©ë‹ˆë‹¤. \nì •ë§ ì‚­ì œë¥¼ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
            if(!result) {
                return;
            }

            $.ajax({
                url: '/patientList/delete',
                method: "POST",
                data: {
                    reg_id : reg_id
                },
                success: function(data) {
                    alert('ì‚­ì œ ìš”ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                },
                error: function(request, status, error) {
                    //console.log("ì—ëŸ¬: ", error);
                    alert("ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
                },
                complete: function() {
                    location.reload();
                }
            }); //end ajax
        }

        function deleteRestore(reg_id, name) {

            var result = confirm(name + 'ë‹˜ì˜ ì •ë³´ì™€ ë…¹ì·¨ íŒŒì¼ì„ ì‚­ì œ ìš”ì²­ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
            if(!result) {
                return;
            }

            $.ajax({
                url: '/patientList/deleteCancel',
                method: "POST",
                data: {
                    reg_id : reg_id
                },
                success: function(data) {
                    alert('ì‚­ì œ ìš”ì²­ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                },
                error: function(request, status, error) {
                    //console.log("ì—ëŸ¬: ", error);
                    alert("ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
                },
                complete: function() {
                    location.reload();
                }
            }); //end ajax
        }

        $('.jDaterange').datepicker({
            todayHighlight: true,
            format: "yyyy-mm-dd",
            autoclose: true
        });

        $('.patientId').click(function(){
            let patientId = $(this).attr('data-patientId');
            let name = $(this).attr('data-name');
            let pId = $(this).text();
            $.ajax({
                url: '/patientList/recList',
                method: "POST",
                data: {
                    patient_id : patientId
                },
                success: function(data) {
                    //console.log(data.list);
                    $('#recLength').text(data.list.length);
                    $('#recListModalLabel').text(name + '(' + pId +')ë‹˜ì˜ ë…¹ì·¨íŒŒì¼ëª©ë¡');

                    let strAdd = '';
                    if(data.list.length == 0) {
                        $('#tbodyArea').html(strAdd);
                        return;
                    }

                    for(var i=0; i<data.list.length; i++) {
                        strAdd += '<tr>';
                            strAdd += '<td>' + data.list[i].id +'</td>';
                            strAdd += '<td><a href="/detail/' + data.list[i].id +'/10/1/dept/from/to/all/all/patient/new">' + data.list[i].filename +'</a></td>';
                            strAdd += '<td>' + data.list[i].created_at +'</td>';
                            strAdd += '<td>' + data.list[i].play_time +'</td>';
                        strAdd += '</tr>';
                    }
                    $('#tbodyArea').html(strAdd);

                },
                error: function(request, status, error) {
                    //console.log("ì—ëŸ¬: ", error);
                    alert("ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
                },
                complete: function() {
                    //console.log("ì™„ë£Œ");
                    $('#recListModal').modal('show');
                }
            }); //end ajax
        });

        //ê²€ìƒ‰
        $(".dropdown-menu .item1").click(function(){
            $("#options").text($(this).text());
            $("#options").val($(this).attr('data-value'));
        });

        $('#searchBtn').click(function() {
            let searchInput = $('#searchInput').val().trim();
            if(searchInput == '') {
                alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            let countperpage = $('#countPerPage option:selected').attr('data-value');
            let order = $('#order option:selected').attr('data-value');
            let key = $('#options').val();
            let is_deleted = $("input[name='box']:checked").attr('value');
            location.href = '?pagenum=1&countperpage=' + countperpage + '&order=' + order + '&key=' + key + '&value=' + searchInput + '&is_deleted=' + is_deleted;
        });


        //ë‚ ì§œ ê²€ìƒ‰
        $(".dropdown-menu .item2").click(function(){
            $("#dateOptions").text($(this).text());
            $("#dateOptions").val($(this).attr('data-value'));
        });

        $('#dateSearchBtn').click(function() {
            let type = $('#dateOptions').val();
            let startdate = $('#startDate').val();
            let enddate = $('#endDate').val();
            if(startdate == '' || enddate == '') {
                alert('ë‚ ì§œë¥¼ ì„ íƒí•˜ì„¸ìš”.');
                return;
            }

            let countperpage = $('#countPerPage option:selected').attr('data-value');
            let order = $('#order option:selected').attr('data-value');
            let department = $('#department option:selected').attr('data-value');
            if(type == 'regDate') { //ë™ì˜ì„œì·¨ë“ì¼ë¡œ ê²€ìƒ‰í•˜ë©´ ë¶€ì„œì„ íƒì´ ë¬´ì˜ë¯¸í•¨.
                department = 'all';
            }
            let is_deleted = $("input[name='box']:checked").attr('value');
            location.href = '?pagenum=1&countperpage=' + countperpage + '&order=' + order + '&type=' + type + '&startdate=' + startdate + '&enddate=' + enddate + '&department=' + department + '&is_deleted=' + is_deleted;
        });


        $("input[name='box']").change(function(){
            let is_deleted = $("input[name='box']:checked").attr('value');
            let countperpage = $('#countPerPage option:selected').attr('data-value');
            let order = $('#order option:selected').attr('data-value');

            location.href = '?pagenum=1&countperpage=' + countperpage + '&order=' + order + '&is_deleted=' + is_deleted;
        });

        $('#rejectListModal').on('show.bs.modal', function (e) {
            var loadurl = $(e.relatedTarget).data('load-url');
            $(this).find('.modal-body').load(loadurl);
        });

        function modifyRegDate(reg_id, reg_date) {
            $('#hiddenRegId2').val(reg_id);
            $('#regDate').val(reg_date);
            $('#regDateModal').modal();
        }

        function regDateModalSubmit() {
            var result = confirm('ì •ë§ ìˆ˜ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
            if(!result) {
                return;
            }

            let reg_id = $('#hiddenRegId2').val();
            $.ajax({
                url: '/patientList/modRegDate',
                method: "POST",
                data: {
                    reg_id : reg_id,
                    reg_date : $('#regDate').val()
                },
                success: function(data) {
                    alert('ìˆ˜ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                },
                error: function(request, status, error) {
                    //console.log("ì—ëŸ¬: ", error);
                    alert("ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
                },
                complete: function() {
                    location.reload();
                }
            }); //end ajax
        }

    </script>

</body>


</html>